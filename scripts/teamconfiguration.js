import * as csScriptGlobals from "cs_script/point_script";
var teamconfiguration;(()=>{let e,t,n,a;var l={507:function(e,t,n){"use strict";n.d(t,{Es:()=>a});function a(e){for(let[t,n]of Object.entries(e))globalThis[t]=n}}},r={};function i(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return l[e](n,n.exports,i),n.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";(0,i(507).Es)(csScriptGlobals)})(),e="player_button_",t={players:[],gameHasStarted:!1},n=e=>{let n=e.GetPlayerSlot(),a=e.IsBot(),l=e.GetPlayerName(),r=e.GetTeamNumber(),i=t.players.find(e=>e.id===n);if(!i){let e={id:n,isBot:a,name:l,currentTeam:r,teamToJoinWhenGameStart:t.players.length%2==0?3:2};return t.players.push(e),Instance.Msg(`Player added: ${l} (id=${n}, bot=${a}, team=${r})`),e}return i.isBot=a,i.name=l,i.currentTeam=r,i},a=()=>{let n,a=Instance.FindEntityByName("ct_players"),l=Instance.FindEntityByName("t_players");if(!a||!l)return void Instance.Msg("Cannot find ct or t anchors");let r=0,i=0;for(let o=0;o<16;o+=1){let s=t.players[o],c=Instance.FindEntityByName(`${e}${o}`);if(!c){Instance.Msg(`Cannot find ${e}${o}`);continue}if(s){let e=3===s.teamToJoinWhenGameStart?a:l;e===l?r-=25:i-=25;let t=e.GetAbsOrigin();c.Teleport({position:{x:t.x,y:t.y,z:t.z+(e===a?i:r)},angles:void 0,velocity:void 0});let n=s.isBot?"BOT ":"";Instance.EntFireAtName({name:`player_name_${o}`,input:"setmessage",value:`${n}${s.name}`,delay:0});continue}if(!n&&!(n=Instance.FindEntityByName("player_button_idle_position"))){Instance.Msg("Cannot find player_button_idle_position");continue}Instance.Msg(`Updating for empty${o}`);let d=n.GetAbsOrigin();c.Teleport({position:{x:d.x,y:d.y,z:d.z+-25*o},angles:void 0,velocity:void 0}),Instance.EntFireAtName({name:`player_name_${o}`,input:"setmessage",value:"Empty",delay:0})}},Instance.OnPlayerConnect(e=>{var t;let l=null==e?void 0:e.player;(null==l||null==(t=l.IsValid)?void 0:t.call(l))&&(n(l),a())}),Instance.OnRoundStart(()=>{a()}),Instance.OnPlayerActivate(e=>{var t;let l=null==e?void 0:e.player;(null==l||null==(t=l.IsValid)?void 0:t.call(l))&&(n(l),a())}),Instance.OnPlayerDisconnect(e=>{"number"==typeof(null==e?void 0:e.playerSlot)&&((e=>{let n=t.players.findIndex(t=>t.id===e);if(-1===n)return;let[a]=t.players.splice(n,1);Instance.Msg(`Player removed: ${a.name} (id=${e})`)})(e.playerSlot),a())}),Instance.OnActivate(()=>{for(let t=0;t<100;t+=1){var e;let a=Instance.GetPlayerController(t);(null==a||null==(e=a.IsValid)?void 0:e.call(a))&&n(a)}a()}),Instance.OnScriptInput("TogglePlayerTeam",n=>{var l;let r=n.caller,i=null==r?void 0:r.GetEntityName();if(!i)return;null==r||null==(l=r.SetHealth)||l.call(r,1e3);let o=Number(i.replace(e,""));if(Number.isNaN(o))return;let s=t.players[o];s&&(s.teamToJoinWhenGameStart=3===s.teamToJoinWhenGameStart?2:3,a())}),Instance.OnScriptInput("StartGame",()=>{for(let n of(t.gameHasStarted=!0,t.players)){var e;let t=n.teamToJoinWhenGameStart,a=Instance.GetPlayerController(n.id);if(!(null==a||null==(e=a.IsValid)?void 0:e.call(a))){Instance.Msg(`No valid controller found for player id=${n.id}, skipping team change.`);continue}try{a.JoinTeam(t),n.currentTeam=t,Instance.Msg(`Moved player: ${n.name} (id=${n.id}) to team ${t}`)}catch(e){Instance.Msg(`Failed to move player id=${n.id} : ${e}`)}}}),Instance.OnScriptReload({before:()=>({configuration:t}),after:e=>{(null==e?void 0:e.configuration)&&(t=e.configuration)}}),Instance.OnGrenadeThrow(e=>{}),teamconfiguration={}})();